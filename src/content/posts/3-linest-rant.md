---
title: "LINEST returns reversed coefficients: a rant"
description: "A rant about excel and google sheets' linest function where the coefficients are reversed"
date: 2023-05-18T12:00:00Z
image: "/images/posts/03.jpg"
categories: ["rants"]
authors: ["Kelvin Soh"]
tags: ["linest", "excel", "google sheets"]
draft: false
---

It is not exactly good form to have the third post in a blog being a rant post
(I swear I'm usually more easy going that this!), but it's frustrating
to get caught in a rabbit hole that feels
so unnecessary (at least to me, and when I try to search more about it).

So I was trying to get a baseline for the HDB price predictor project
(peek behind the curtain: albeit retroactively; I have already tried the fastai library and will be posting
about it in a later post). And the well understood field of linear regression
is definitely the place to start, and spreadsheets conveniently help us do that!

So I pulled up Google Sheets, and ran `LINEST()`, which gave me the results in an instant:
the coefficients, r2 value and standard error. Pretty nifty! And then I tried to dig a bit
deeper, and struggled to get predictions from the results.

Diving into the docs didn't help much: I pretty much recreated the example. I briefly thought that
maybe the coefficients were in the wrong order, but was pretty sure the last coefficient is the constant
based on eyeballing the numbers, and besides **_why would anyone reverse the coefficients: it sure will make
using `SUMPRODUCT()` very inconvenient_**.

And after some more google searching, and looking at a video example on YouTube did I find it it was indeed
the coefficients were reversed (with the constant at the end)!

> When giving data of the form `x_1, x_2, ... x_n`, `LINEST()` returns the coefficients
> in the form `b_n, ... b_2, b_1, b_0`

Maybe the authors of the function were trying to create this descending index to fit
the fact that the constant is typically called `b_0`, but I think this quote sums up the situation
perfectly:

> And there is absolutely no good reason for itâ€”statistical, theoretical or programmatic
> -- [Conrad Carlberg](https://www.informit.com/articles/article.aspx?p=2019171)

An order of `b_1, ... b_n, b_0` will be the natural way most people will approach the result,
and if you really insist on nice indexing, `b_0, b_1, ..., b_n` will work too (though you could argue against this since sometimes this
coefficient is forced, often to 0).

A google search on **_why_** this is the case yielded little results. Some lamented about this
arrangement, some just state the results matter-of-factly, and most of my
search results were questions about how to reverse (un-reverse?) the coefficients.

Credit where credit's due, the example on Microsoft's docs on `LINEST()` shows that the coefficients are reversed, but
unfortunately for me I went to the Google Sheet's docs which did not (have filed a suggestion: hope it gets implemented!)

Which brings me to my rant. It's so easy to see how this situation occurred (all pure conjecture from me from here on): the initial
programmer who wrote the function in Excel decided to do it that way. It got shipped, and to prevent breaking change
this continued. Google Sheets, so as to be similar Excel, adopted the same convention.

Now we're stuck with this unintuitive
convention leading to frequent questions all the way back to
[2006](https://www.pcreview.co.uk/threads/linest-parameter-output-order.2431662/),
and replies teaching workarounds.
I will like to live in a world where the "why" gets bubbled up more often than these,
and lead to change for the better ([semver](https://semver.org/) FTW).

## The cover image

Generated by [Stable Diffusion Online](https://stablediffusionweb.com/).
I used the following prompts, and got something I like at the 4th attempt.

I'm not sure if it's projection, but I can totally feel the frustration in the robot's eyes
and typing away like I am doing here (I find it amusing the monitor is behind him though!)
All the picture needs extra is the anime angry symbol on its face ðŸ’¢.

1. Rant
2. Angrily slamming computer keyboard
3. Robot frustrated at computer
4. Robot frustrated and slamming table in front of a computer
